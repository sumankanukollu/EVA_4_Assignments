# EVA4 Assignment 12 - Suman Kanukollu

**Team Members**

- Tusharkant Biswal (Tusharkanta_biswal@stragure.com) 
- Praveen Raghuvanshi (praveenraghuvanshi@gmail.com)
- V N G Suman Kanukollu (sumankanukollu@gmail.com)

- [Github Directory](https://github.com/sumankanukollu/EVA_4_Assignments/tree/S_12_TinyImageNet)

### Assignment 12-A

- [Github Directory](https://github.com/sumankanukollu/EVA_4_Assignments/blob/d56619a277795fca713a0e4cd43d26395e0bf825/EVA4_S12_TinyImagenet_Resnet18.ipynb)

- [Colab link](https://colab.research.google.com/drive/15ZpF_zY478twcXg-ibD_AIwGmLXYUd1P#scrollTo=IUIBoB40IR6h)

- Model: [ResNet18]https://github.com/sumankanukollu/EVA_4_Assignments/blob/d56619a277795fca713a0e4cd43d26395e0bf825/models/resnet.py) 

- No of parameters: 11,279,112

- No of Epochs : 50

- Best Test Acc: 
    '''
    Target-50.0% achieved at 32th epoach,Train accuracy is : 51.03988646698448
    Target-50.0% achieved at 25th epoach,Test accuracy is : 51.087247364383956
    '''
- Code Modularity

  - **EVA4_S12_TinyImagenet_Resnet18.ipynb** : It contains main workflow
  - **dataloader_s12_10.py**: It contains all the functions related to setup, train, load dataset etc.
  - **models** : It contains Resnet18 Model 
  - **utils.py** : It contains helper functions such as progress bar
  - **gradcam/gradcam.py**: GradCAM and GRADCAM++ implementation
  - **gradcam/gradcam_utils.py**: Utitlity functions used in GradCAM such as visual_cam
  - **Folders**:
    - **sampleimages**: 50 Dog Images from internet

- **Train vs Test (Accuracy and Loss) Graph**:
![Train Vs test Acc/loss graph](https://github.com/sumankanukollu/EVA_4_Assignments/blob/S_12_TinyImageNet/sampleImages/trainTestAccLossGraph.JPG)
- Logs

  - Best accuracy

    ```python
    Epoch: 50
     [================================================================>]  Step: 376ms | Tot: 58s589ms | Train >> Loss: 0.616 | Acc: 84.019% (84069/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 18s52ms | Test >> Loss: 0.576 | Acc: 88.881% (49826/56059) 55/55 
    0.0005655203455660945
    ```
    
  - Full
  
  ```python
  

    EPOCH: 1 LR: 0.0245471

    Epoch: 1
     [================================================================>]  Step: 368ms | Tot: 59s100ms | Train >> Loss: 5.246 | Acc: 1.257% (1258/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 19s485ms | Test >> Loss: 5.007 | Acc: 2.827% (1585/56059) 55/55 
    0.004912193737725138
    
    EPOCH: 2 LR: 0.036174673684210526

    Epoch: 2
     [================================================================>]  Step: 377ms | Tot: 59s493ms | Train >> Loss: 4.931 | Acc: 3.634% (3636/100059) 98/98 
     [===============================================================>.]  Step: 87ms | Tot: 18s615ms | Test >> Loss: 4.806 | Acc: 5.626% (3154/56059) 55/55 
    0.004715363126486754

    EPOCH: 3 LR: 0.04780224736842105

    Epoch: 3
     [================================================================>]  Step: 375ms | Tot: 59s739ms | Train >> Loss: 4.627 | Acc: 6.529% (6533/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 18s826ms | Test >> Loss: 4.248 | Acc: 10.551% (5915/56059) 55/55 
    0.00416756710597622

    EPOCH: 4 LR: 0.05942982105263157

    Epoch: 4
     [================================================================>]  Step: 375ms | Tot: 59s314ms | Train >> Loss: 4.389 | Acc: 9.265% (9270/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 18s989ms | Test >> Loss: 4.019 | Acc: 13.559% (7601/56059) 55/55 
    0.003942852285310245

    EPOCH: 5 LR: 0.0710573947368421

    Epoch: 5
     [================================================================>]  Step: 374ms | Tot: 59s650ms | Train >> Loss: 4.195 | Acc: 11.646% (11653/100059) 98/98 
     [===============================================================>.]  Step: 83ms | Tot: 19s93ms | Test >> Loss: 3.816 | Acc: 16.556% (9281/56059) 55/55 
    0.0037438064682302707

    EPOCH: 6 LR: 0.08268496842105263

    Epoch: 6
     [================================================================>]  Step: 378ms | Tot: 58s702ms | Train >> Loss: 4.046 | Acc: 13.761% (13769/100059) 98/98 
     [===============================================================>.]  Step: 90ms | Tot: 18s446ms | Test >> Loss: 3.583 | Acc: 20.168% (11306/56059) 55/55 
    0.003515442561877012

    EPOCH: 7 LR: 0.09431254210526316

    Epoch: 7
     [================================================================>]  Step: 380ms | Tot: 59s884ms | Train >> Loss: 3.905 | Acc: 15.787% (15796/100059) 98/98 
     [===============================================================>.]  Step: 87ms | Tot: 18s969ms | Test >> Loss: 3.419 | Acc: 23.029% (12910/56059) 55/55 
    0.0033548089809292175

    EPOCH: 8 LR: 0.10594011578947368

    Epoch: 8
     [================================================================>]  Step: 377ms | Tot: 1m898ms | Train >> Loss: 3.804 | Acc: 17.171% (17181/100059) 98/98 
     [===============================================================>.]  Step: 82ms | Tot: 18s748ms | Test >> Loss: 3.339 | Acc: 24.385% (13670/56059) 55/55 
    0.0032759138323113723

    EPOCH: 9 LR: 0.1175676894736842

    Epoch: 9
     [================================================================>]  Step: 378ms | Tot: 59s494ms | Train >> Loss: 3.689 | Acc: 18.912% (18923/100059) 98/98 
     [===============================================================>.]  Step: 83ms | Tot: 19s128ms | Test >> Loss: 3.290 | Acc: 25.068% (14053/56059) 55/55 
    0.0032282735650756597

    EPOCH: 10 LR: 0.12919526315789473

    Epoch: 10
     [================================================================>]  Step: 374ms | Tot: 59s412ms | Train >> Loss: 3.593 | Acc: 20.745% (20757/100059) 98/98 
     [===============================================================>.]  Step: 92ms | Tot: 19s99ms | Test >> Loss: 3.311 | Acc: 25.088% (14064/56059) 55/55 
    0.0032483984680235665

    EPOCH: 11 LR: 0.14082283684210525

    Epoch: 11
     [================================================================>]  Step: 375ms | Tot: 1m141ms | Train >> Loss: 3.503 | Acc: 22.113% (22126/100059) 98/98 
     [===============================================================>.]  Step: 92ms | Tot: 19s211ms | Test >> Loss: 3.069 | Acc: 29.671% (16633/56059) 55/55 
    0.003011494975431202

    EPOCH: 12 LR: 0.15245041052631578

    Epoch: 12
     [================================================================>]  Step: 374ms | Tot: 59s271ms | Train >> Loss: 3.424 | Acc: 23.265% (23279/100059) 98/98 
     [===============================================================>.]  Step: 89ms | Tot: 19s68ms | Test >> Loss: 3.189 | Acc: 27.641% (15495/56059) 55/55 
    0.0031288159017134674

    EPOCH: 13 LR: 0.1640779842105263

    Epoch: 13
     [================================================================>]  Step: 378ms | Tot: 59s372ms | Train >> Loss: 3.348 | Acc: 24.605% (24620/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 18s97ms | Test >> Loss: 2.855 | Acc: 33.343% (18692/56059) 55/55 
    0.0028007443325168135

    EPOCH: 14 LR: 0.17570555789473685

    Epoch: 14
     [================================================================>]  Step: 380ms | Tot: 58s731ms | Train >> Loss: 3.248 | Acc: 26.346% (26362/100059) 98/98 
     [===============================================================>.]  Step: 83ms | Tot: 18s293ms | Test >> Loss: 2.774 | Acc: 34.166% (19153/56059) 55/55 
    0.00272136220760356

    EPOCH: 15 LR: 0.18733313157894735

    Epoch: 15
     [================================================================>]  Step: 381ms | Tot: 58s843ms | Train >> Loss: 3.174 | Acc: 27.564% (27580/100059) 98/98 
     [===============================================================>.]  Step: 82ms | Tot: 18s363ms | Test >> Loss: 2.756 | Acc: 34.819% (19519/56059) 55/55 
    0.002704068964935718

    EPOCH: 16 LR: 0.1989607052631579

    Epoch: 16
     [================================================================>]  Step: 376ms | Tot: 58s902ms | Train >> Loss: 3.118 | Acc: 28.535% (28552/100059) 98/98 
     [===============================================================>.]  Step: 81ms | Tot: 18s218ms | Test >> Loss: 2.742 | Acc: 34.954% (19595/56059) 55/55 
    0.0026901494648839384

    EPOCH: 17 LR: 0.2105882789473684

    Epoch: 17
     [================================================================>]  Step: 384ms | Tot: 59s270ms | Train >> Loss: 3.058 | Acc: 29.581% (29598/100059) 98/98 
     [===============================================================>.]  Step: 82ms | Tot: 18s35ms | Test >> Loss: 2.681 | Acc: 36.371% (20389/56059) 55/55 
    0.002629936778091798

    EPOCH: 18 LR: 0.22221585263157895

    Epoch: 18
     [================================================================>]  Step: 376ms | Tot: 59s212ms | Train >> Loss: 2.976 | Acc: 31.034% (31052/100059) 98/98 
     [===============================================================>.]  Step: 81ms | Tot: 17s943ms | Test >> Loss: 2.544 | Acc: 39.186% (21967/56059) 55/55 
    0.002496390212655852

    EPOCH: 19 LR: 0.23384342631578944

    Epoch: 19
     [================================================================>]  Step: 375ms | Tot: 58s695ms | Train >> Loss: 2.916 | Acc: 32.065% (32084/100059) 98/98 
     [===============================================================>.]  Step: 86ms | Tot: 18s432ms | Test >> Loss: 2.784 | Acc: 35.022% (19633/56059) 55/55 
    0.0027314695536800036

    EPOCH: 20 LR: 0.245471

    Epoch: 20
     [================================================================>]  Step: 382ms | Tot: 58s934ms | Train >> Loss: 2.870 | Acc: 33.028% (33047/100059) 98/98 
     [===============================================================>.]  Step: 87ms | Tot: 18s323ms | Test >> Loss: 2.357 | Acc: 42.537% (23846/56059) 55/55 
    0.0023120606344730625

    EPOCH: 21 LR: 0.2372968157

    Epoch: 21
     [================================================================>]  Step: 378ms | Tot: 58s484ms | Train >> Loss: 2.769 | Acc: 34.940% (34961/100059) 98/98 
     [===============================================================>.]  Step: 88ms | Tot: 18s156ms | Test >> Loss: 2.380 | Acc: 42.222% (23669/56059) 55/55 
    0.00233504399581493

    EPOCH: 22 LR: 0.2291226314

    Epoch: 22
     [================================================================>]  Step: 370ms | Tot: 58s993ms | Train >> Loss: 2.689 | Acc: 36.310% (36331/100059) 98/98 
     [===============================================================>.]  Step: 83ms | Tot: 18s461ms | Test >> Loss: 2.252 | Acc: 44.846% (25140/56059) 55/55 
    0.0022099147600584857

    EPOCH: 23 LR: 0.2209484471

    Epoch: 23
     [================================================================>]  Step: 377ms | Tot: 58s547ms | Train >> Loss: 2.620 | Acc: 37.597% (37619/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 18s378ms | Test >> Loss: 2.191 | Acc: 46.360% (25989/56059) 55/55 
    0.0021493277800415105

    EPOCH: 24 LR: 0.2127742628

    Epoch: 24
     [================================================================>]  Step: 377ms | Tot: 58s327ms | Train >> Loss: 2.526 | Acc: 39.401% (39424/100059) 98/98 
     [===============================================================>.]  Step: 83ms | Tot: 18s385ms | Test >> Loss: 2.074 | Acc: 48.592% (27240/56059) 55/55 
    0.002035216192647204

    EPOCH: 25 LR: 0.2046000785

    Epoch: 25
     [================================================================>]  Step: 375ms | Tot: 58s815ms | Train >> Loss: 2.467 | Acc: 40.378% (40402/100059) 98/98 
     [===============================================================>.]  Step: 81ms | Tot: 18s343ms | Test >> Loss: 1.971 | Acc: 51.087% (28639/56059) 55/55 
    0.001933687474415078

    EPOCH: 26 LR: 0.1964258942

    Epoch: 26
     [================================================================>]  Step: 375ms | Tot: 58s797ms | Train >> Loss: 2.384 | Acc: 42.152% (42177/100059) 98/98 
     [===============================================================>.]  Step: 87ms | Tot: 18s502ms | Test >> Loss: 1.948 | Acc: 51.226% (28717/56059) 55/55 
    0.0019110765434867632

    EPOCH: 27 LR: 0.1882517099

    Epoch: 27
     [================================================================>]  Step: 375ms | Tot: 59s529ms | Train >> Loss: 2.312 | Acc: 43.445% (43471/100059) 98/98 
     [===============================================================>.]  Step: 81ms | Tot: 18s423ms | Test >> Loss: 1.791 | Acc: 54.905% (30779/56059) 55/55 
    0.0017572354678369005

    EPOCH: 28 LR: 0.1800775256

    Epoch: 28
     [================================================================>]  Step: 374ms | Tot: 58s880ms | Train >> Loss: 2.223 | Acc: 45.309% (45336/100059) 98/98 
     [===============================================================>.]  Step: 82ms | Tot: 18s601ms | Test >> Loss: 1.669 | Acc: 58.057% (32546/56059) 55/55 
    0.0016377434669031495

    EPOCH: 29 LR: 0.1719033413

    Epoch: 29
     [================================================================>]  Step: 376ms | Tot: 1m231ms | Train >> Loss: 2.162 | Acc: 46.656% (46684/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 19s34ms | Test >> Loss: 1.658 | Acc: 58.149% (32598/56059) 55/55 
    0.0016267990210701952

    EPOCH: 30 LR: 0.16372915700000001

    Epoch: 30
     [================================================================>]  Step: 375ms | Tot: 1m768ms | Train >> Loss: 2.094 | Acc: 47.853% (47881/100059) 98/98 
     [===============================================================>.]  Step: 82ms | Tot: 18s746ms | Test >> Loss: 1.580 | Acc: 59.955% (33610/56059) 55/55 
    0.0015498346168040234

    EPOCH: 31 LR: 0.15555497270000002

    Epoch: 31
     [================================================================>]  Step: 375ms | Tot: 1m1s | Train >> Loss: 2.010 | Acc: 49.668% (49697/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 18s286ms | Test >> Loss: 1.491 | Acc: 62.372% (34965/56059) 55/55 
    0.0014623549979770666

    EPOCH: 32 LR: 0.1473807884

    Epoch: 32
     [================================================================>]  Step: 374ms | Tot: 58s898ms | Train >> Loss: 1.943 | Acc: 51.040% (51070/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 17s937ms | Test >> Loss: 1.360 | Acc: 65.733% (36849/56059) 55/55 
    0.0013346278379734922

    EPOCH: 33 LR: 0.1392066041

    Epoch: 33
     [================================================================>]  Step: 379ms | Tot: 59s479ms | Train >> Loss: 1.855 | Acc: 53.165% (53196/100059) 98/98 
     [===============================================================>.]  Step: 83ms | Tot: 18s185ms | Test >> Loss: 1.306 | Acc: 67.256% (37703/56059) 55/55 
    0.001281580499433234

    EPOCH: 34 LR: 0.1310324198

    Epoch: 34
     [================================================================>]  Step: 379ms | Tot: 58s621ms | Train >> Loss: 1.770 | Acc: 54.853% (54885/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 18s310ms | Test >> Loss: 1.245 | Acc: 68.844% (38593/56059) 55/55 
    0.001221969460281674

    EPOCH: 35 LR: 0.1228582355

    Epoch: 35
     [================================================================>]  Step: 379ms | Tot: 58s711ms | Train >> Loss: 1.699 | Acc: 56.349% (56382/100059) 98/98 
     [===============================================================>.]  Step: 85ms | Tot: 18s363ms | Test >> Loss: 1.179 | Acc: 70.708% (39638/56059) 55/55 
    0.0011566145977769538

    EPOCH: 36 LR: 0.1146840512

    Epoch: 36
     [================================================================>]  Step: 375ms | Tot: 58s454ms | Train >> Loss: 1.622 | Acc: 58.138% (58172/100059) 98/98 
     [===============================================================>.]  Step: 82ms | Tot: 18s388ms | Test >> Loss: 1.155 | Acc: 71.485% (40074/56059) 55/55 
    0.0011336574795332928

    EPOCH: 37 LR: 0.1065098669

    Epoch: 37
     [================================================================>]  Step: 372ms | Tot: 58s513ms | Train >> Loss: 1.529 | Acc: 60.257% (60293/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 18s230ms | Test >> Loss: 1.109 | Acc: 72.936% (40887/56059) 55/55 
    0.001087988142124366

    EPOCH: 38 LR: 0.0983356826

    Epoch: 38
     [================================================================>]  Step: 373ms | Tot: 58s271ms | Train >> Loss: 1.446 | Acc: 62.281% (62318/100059) 98/98 
     [===============================================================>.]  Step: 81ms | Tot: 18s167ms | Test >> Loss: 0.972 | Acc: 76.819% (43064/56059) 55/55 
    0.0009532913204928646

    EPOCH: 39 LR: 0.0901614983

    Epoch: 39
     [================================================================>]  Step: 369ms | Tot: 58s832ms | Train >> Loss: 1.369 | Acc: 64.293% (64331/100059) 98/98 
     [===============================================================>.]  Step: 81ms | Tot: 18s205ms | Test >> Loss: 0.902 | Acc: 78.740% (44141/56059) 55/55 
    0.000884957247531134

    EPOCH: 40 LR: 0.081987314

    Epoch: 40
     [================================================================>]  Step: 372ms | Tot: 58s469ms | Train >> Loss: 1.269 | Acc: 66.374% (66413/100059) 98/98 
     [===============================================================>.]  Step: 85ms | Tot: 17s536ms | Test >> Loss: 0.886 | Acc: 79.379% (44499/56059) 55/55 
    0.0008693254932411118

    EPOCH: 41 LR: 0.07381312970000001

    Epoch: 41
     [================================================================>]  Step: 373ms | Tot: 58s128ms | Train >> Loss: 1.202 | Acc: 68.246% (68286/100059) 98/98 
     [===============================================================>.]  Step: 82ms | Tot: 18s124ms | Test >> Loss: 0.832 | Acc: 81.343% (45600/56059) 55/55 
    0.0008158929249024778

    EPOCH: 42 LR: 0.06563894540000001

    Epoch: 42
     [================================================================>]  Step: 374ms | Tot: 58s243ms | Train >> Loss: 1.106 | Acc: 70.766% (70808/100059) 98/98 
     [===============================================================>.]  Step: 87ms | Tot: 17s559ms | Test >> Loss: 0.794 | Acc: 82.677% (46348/56059) 55/55 
    0.000778938615042904

    EPOCH: 43 LR: 0.057464761099999984

    Epoch: 43
     [================================================================>]  Step: 375ms | Tot: 58s219ms | Train >> Loss: 1.038 | Acc: 72.496% (72539/100059) 98/98 
     [===============================================================>.]  Step: 83ms | Tot: 18s149ms | Test >> Loss: 0.736 | Acc: 84.274% (47243/56059) 55/55 
    0.0007222124230485486

    EPOCH: 44 LR: 0.049290576799999986

    Epoch: 44
     [================================================================>]  Step: 373ms | Tot: 58s443ms | Train >> Loss: 0.951 | Acc: 74.832% (74876/100059) 98/98 
     [===============================================================>.]  Step: 87ms | Tot: 18s41ms | Test >> Loss: 0.701 | Acc: 85.348% (47845/56059) 55/55 
    0.0006882391215991119

    EPOCH: 45 LR: 0.04111639249999999

    Epoch: 45
     [================================================================>]  Step: 370ms | Tot: 57s862ms | Train >> Loss: 0.872 | Acc: 76.822% (76867/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 17s894ms | Test >> Loss: 0.657 | Acc: 86.643% (48571/56059) 55/55 
    0.0006443742539663673

    EPOCH: 46 LR: 0.03294220819999999

    Epoch: 46
     [================================================================>]  Step: 374ms | Tot: 57s879ms | Train >> Loss: 0.811 | Acc: 78.409% (78455/100059) 98/98 
     [===============================================================>.]  Step: 88ms | Tot: 17s959ms | Test >> Loss: 0.633 | Acc: 87.383% (48986/56059) 55/55 
    0.0006211235664465801

    EPOCH: 47 LR: 0.02476802389999999

    Epoch: 47
     [================================================================>]  Step: 372ms | Tot: 57s916ms | Train >> Loss: 0.742 | Acc: 80.413% (80460/100059) 98/98 
     [===============================================================>.]  Step: 83ms | Tot: 17s862ms | Test >> Loss: 0.611 | Acc: 87.938% (49297/56059) 55/55 
    0.0005989674682182021

    EPOCH: 48 LR: 0.016593839599999993

    Epoch: 48
     [================================================================>]  Step: 373ms | Tot: 58s411ms | Train >> Loss: 0.689 | Acc: 81.950% (81998/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 17s995ms | Test >> Loss: 0.589 | Acc: 88.537% (49633/56059) 55/55 
    0.0005776549385498958

    EPOCH: 49 LR: 0.008419655299999995

    Epoch: 49
     [================================================================>]  Step: 372ms | Tot: 58s160ms | Train >> Loss: 0.645 | Acc: 83.073% (83122/100059) 98/98 
     [===============================================================>.]  Step: 81ms | Tot: 17s791ms | Test >> Loss: 0.578 | Acc: 88.824% (49794/56059) 55/55 
    0.0005675701742756263

    EPOCH: 50 LR: 0.0002454709999999971

    Epoch: 50
     [================================================================>]  Step: 376ms | Tot: 58s589ms | Train >> Loss: 0.616 | Acc: 84.019% (84069/100059) 98/98 
     [===============================================================>.]  Step: 84ms | Tot: 18s52ms | Test >> Loss: 0.576 | Acc: 88.881% (49826/56059) 55/55 
    0.0005655203455660945
  ```
  
  
  
- Analysis

  - No of Epochs : 50
  - Batch size : 1024
  - Best Test Acc: 88.88% {Epoch-50)
  - Model: ResNet18
  - Albumentations: Yes
  - Hyperparameters
    - Optimizer: SGD
    - Max Learning rate: 0.245471
    - Momentum: 0.9
    - Scheduler: One Cycle Policy
    
    
### Assignment 12-B

- [Github Directory](https://github.com/sumankanukollu/EVA_4_Assignments/blob/S_12_TinyImageNet/EVA4_S12_Suman_K_MeansAnchor.ipynb)

- [Colab link](https://colab.research.google.com/drive/11qClaWfCTUPxZ5PdTqnFaGApQ3IrISwq?authuser=1#scrollTo=i4glrfCgzhRS)

- [Annotations Link](https://github.com/sumankanukollu/EVA_4_Assignments/tree/S_12_TinyImageNet/sampleImages/50_dogAnnotations)
