# EVA4 Assignment 9 - Suman Kanukollu



- [Github link](https://github.com/sumankanukollu/EVA_4_Assignments/blob/master/pytorch_Framework_suman-S9/pytorch_Framework_suman/EVA-4-S9-Suman-Kanukollu-Main.ipynb) 

- [Colab link](https://colab.research.google.com/drive/1QkYKTOiKwLPeoTX4ABH0hKAmcI7TiZ3-?authuser=1#scrollTo=SxPAatn3-Ez8)

- Model: Resnet18

- No of parameters: 11,173,962

- No of Epochs : 60

- Best Test Acc: 87.880%

- Code Modularity

  - EVA-4-S9-Suman-Kanukollu-Main.ipynb : It contains main workflow
  - lib: It contains all the functions related to setup, train, load dataset etc.
  - model.py : It contains Resnet model
  - Utils.py : It contains helper functions such as progress bar and random images display and saveimages

- Logs

  - **Best accuracy**

    ```
  
		Epoch: 59
		 [================================================================>]  Step: 95ms | Tot: 55s70ms | Train >> Loss: 0.226 | Acc: 92.140% (46070/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s524ms | Test >> Loss: 0.427 | Acc: 87.880% (8788/10000) 79/79 
    ```

  - **Full Log**

    ```
    
    
		Epoch: 0
		 [================================================================>]  Step: 92ms | Tot: 54s546ms | Train >> Loss: 1.727 | Acc: 36.292% (18146/50000) 391/391 
		 [================================================================>]  Step: 61ms | Tot: 3s511ms | Test >> Loss: 1.366 | Acc: 49.340% (4934/10000) 79/79 
		
		Epoch: 1
		 [================================================================>]  Step: 92ms | Tot: 55s43ms | Train >> Loss: 1.396 | Acc: 49.268% (24634/50000) 391/391 
		 [================================================================>]  Step: 65ms | Tot: 3s476ms | Test >> Loss: 1.179 | Acc: 57.680% (5768/10000) 79/79 
		
		Epoch: 2
		 [================================================================>]  Step: 89ms | Tot: 55s220ms | Train >> Loss: 1.224 | Acc: 56.130% (28065/50000) 391/391 
		 [================================================================>]  Step: 61ms | Tot: 3s562ms | Test >> Loss: 1.016 | Acc: 63.940% (6394/10000) 79/79 
		
		Epoch: 3
		 [================================================================>]  Step: 93ms | Tot: 55s168ms | Train >> Loss: 1.112 | Acc: 60.102% (30051/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s531ms | Test >> Loss: 0.884 | Acc: 69.030% (6903/10000) 79/79 
		
		Epoch: 4
		 [================================================================>]  Step: 94ms | Tot: 55s82ms | Train >> Loss: 1.015 | Acc: 63.848% (31924/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s537ms | Test >> Loss: 0.903 | Acc: 68.250% (6825/10000) 79/79 
		
		Epoch: 5
		 [================================================================>]  Step: 91ms | Tot: 54s307ms | Train >> Loss: 0.943 | Acc: 66.446% (33223/50000) 391/391 
		 [================================================================>]  Step: 62ms | Tot: 3s525ms | Test >> Loss: 0.781 | Acc: 72.960% (7296/10000) 79/79 
		
		Epoch: 6
		 [================================================================>]  Step: 91ms | Tot: 55s117ms | Train >> Loss: 0.884 | Acc: 68.942% (34471/50000) 391/391 
		 [================================================================>]  Step: 61ms | Tot: 3s509ms | Test >> Loss: 0.803 | Acc: 72.220% (7222/10000) 79/79 
		
		Epoch: 7
		 [================================================================>]  Step: 91ms | Tot: 55s42ms | Train >> Loss: 0.832 | Acc: 70.582% (35291/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s456ms | Test >> Loss: 0.724 | Acc: 74.490% (7449/10000) 79/79 
		
		Epoch: 8
		 [================================================================>]  Step: 91ms | Tot: 55s103ms | Train >> Loss: 0.790 | Acc: 72.314% (36157/50000) 391/391 
		 [================================================================>]  Step: 63ms | Tot: 3s452ms | Test >> Loss: 0.700 | Acc: 76.130% (7613/10000) 79/79 
		
		Epoch: 9
		 [================================================================>]  Step: 95ms | Tot: 55s133ms | Train >> Loss: 0.746 | Acc: 73.732% (36866/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s514ms | Test >> Loss: 0.693 | Acc: 76.440% (7644/10000) 79/79 
		
		Epoch: 10
		 [================================================================>]  Step: 92ms | Tot: 54s744ms | Train >> Loss: 0.715 | Acc: 74.874% (37437/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s476ms | Test >> Loss: 0.658 | Acc: 77.880% (7788/10000) 79/79 
		
		Epoch: 11
		 [================================================================>]  Step: 93ms | Tot: 55s187ms | Train >> Loss: 0.678 | Acc: 76.250% (38125/50000) 391/391 
		 [================================================================>]  Step: 61ms | Tot: 3s522ms | Test >> Loss: 0.601 | Acc: 79.610% (7961/10000) 79/79 
		
		Epoch: 12
		 [================================================================>]  Step: 97ms | Tot: 55s133ms | Train >> Loss: 0.648 | Acc: 77.324% (38662/50000) 391/391 
		 [================================================================>]  Step: 70ms | Tot: 3s466ms | Test >> Loss: 0.591 | Acc: 79.540% (7954/10000) 79/79 
		
		Epoch: 13
		 [================================================================>]  Step: 94ms | Tot: 55s14ms | Train >> Loss: 0.622 | Acc: 78.198% (39099/50000) 391/391 
		 [================================================================>]  Step: 63ms | Tot: 3s465ms | Test >> Loss: 0.655 | Acc: 77.920% (7792/10000) 79/79 
		
		Epoch: 14
		 [================================================================>]  Step: 91ms | Tot: 55s39ms | Train >> Loss: 0.594 | Acc: 79.258% (39629/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s571ms | Test >> Loss: 0.564 | Acc: 81.080% (8108/10000) 79/79 
		
		Epoch: 15
		 [================================================================>]  Step: 95ms | Tot: 55s190ms | Train >> Loss: 0.569 | Acc: 80.092% (40046/50000) 391/391 
		 [================================================================>]  Step: 62ms | Tot: 3s468ms | Test >> Loss: 0.558 | Acc: 81.340% (8134/10000) 79/79 
		
		Epoch: 16
		 [================================================================>]  Step: 95ms | Tot: 55s148ms | Train >> Loss: 0.552 | Acc: 80.898% (40449/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s551ms | Test >> Loss: 0.569 | Acc: 81.050% (8105/10000) 79/79 
		
		Epoch: 17
		 [================================================================>]  Step: 91ms | Tot: 55s83ms | Train >> Loss: 0.534 | Acc: 81.484% (40742/50000) 391/391 
		 [================================================================>]  Step: 61ms | Tot: 3s583ms | Test >> Loss: 0.604 | Acc: 80.490% (8049/10000) 79/79 
		
		Epoch: 18
		 [================================================================>]  Step: 97ms | Tot: 55s266ms | Train >> Loss: 0.512 | Acc: 82.184% (41092/50000) 391/391 
		 [================================================================>]  Step: 65ms | Tot: 3s574ms | Test >> Loss: 0.522 | Acc: 82.100% (8210/10000) 79/79 
		
		Epoch: 19
		 [================================================================>]  Step: 93ms | Tot: 55s253ms | Train >> Loss: 0.500 | Acc: 82.706% (41353/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s534ms | Test >> Loss: 0.497 | Acc: 83.520% (8352/10000) 79/79 
		
		Epoch: 20
		 [================================================================>]  Step: 91ms | Tot: 55s251ms | Train >> Loss: 0.481 | Acc: 83.400% (41700/50000) 391/391 
		 [================================================================>]  Step: 68ms | Tot: 3s628ms | Test >> Loss: 0.512 | Acc: 83.130% (8313/10000) 79/79 
		
		Epoch: 21
		 [================================================================>]  Step: 94ms | Tot: 55s120ms | Train >> Loss: 0.469 | Acc: 83.838% (41919/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s527ms | Test >> Loss: 0.543 | Acc: 82.480% (8248/10000) 79/79 
		
		Epoch: 22
		 [================================================================>]  Step: 97ms | Tot: 55s175ms | Train >> Loss: 0.455 | Acc: 84.302% (42151/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s595ms | Test >> Loss: 0.554 | Acc: 82.300% (8230/10000) 79/79 
		
		Epoch: 23
		 [================================================================>]  Step: 94ms | Tot: 55s126ms | Train >> Loss: 0.436 | Acc: 84.950% (42475/50000) 391/391 
		 [================================================================>]  Step: 63ms | Tot: 3s484ms | Test >> Loss: 0.496 | Acc: 83.810% (8381/10000) 79/79 
		
		Epoch: 24
		 [================================================================>]  Step: 90ms | Tot: 55s150ms | Train >> Loss: 0.428 | Acc: 85.216% (42608/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s528ms | Test >> Loss: 0.610 | Acc: 80.480% (8048/10000) 79/79 
		
		Epoch: 25
		 [================================================================>]  Step: 92ms | Tot: 55s145ms | Train >> Loss: 0.420 | Acc: 85.560% (42780/50000) 391/391 
		 [================================================================>]  Step: 65ms | Tot: 3s526ms | Test >> Loss: 0.558 | Acc: 82.410% (8241/10000) 79/79 
		
		Epoch: 26
		 [================================================================>]  Step: 96ms | Tot: 55s55ms | Train >> Loss: 0.404 | Acc: 86.006% (43003/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s557ms | Test >> Loss: 0.483 | Acc: 84.300% (8430/10000) 79/79 
		
		Epoch: 27
		 [================================================================>]  Step: 95ms | Tot: 55s31ms | Train >> Loss: 0.393 | Acc: 86.402% (43201/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s438ms | Test >> Loss: 0.501 | Acc: 83.850% (8385/10000) 79/79 
		
		Epoch: 28
		 [================================================================>]  Step: 91ms | Tot: 54s987ms | Train >> Loss: 0.391 | Acc: 86.568% (43284/50000) 391/391 
		 [================================================================>]  Step: 65ms | Tot: 3s524ms | Test >> Loss: 0.495 | Acc: 84.390% (8439/10000) 79/79 
		
		Epoch: 29
		 [================================================================>]  Step: 95ms | Tot: 55s85ms | Train >> Loss: 0.381 | Acc: 86.802% (43401/50000) 391/391 
		 [================================================================>]  Step: 65ms | Tot: 3s458ms | Test >> Loss: 0.473 | Acc: 85.340% (8534/10000) 79/79 
		
		Epoch: 30
		 [================================================================>]  Step: 96ms | Tot: 55s281ms | Train >> Loss: 0.367 | Acc: 87.418% (43709/50000) 391/391 
		 [================================================================>]  Step: 62ms | Tot: 3s503ms | Test >> Loss: 0.507 | Acc: 84.840% (8484/10000) 79/79 
		
		Epoch: 31
		 [================================================================>]  Step: 94ms | Tot: 54s826ms | Train >> Loss: 0.353 | Acc: 87.944% (43972/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s470ms | Test >> Loss: 0.454 | Acc: 85.960% (8596/10000) 79/79 
		
		Epoch: 32
		 [================================================================>]  Step: 94ms | Tot: 55s191ms | Train >> Loss: 0.348 | Acc: 88.062% (44031/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s578ms | Test >> Loss: 0.481 | Acc: 85.280% (8528/10000) 79/79 
		
		Epoch: 33
		 [================================================================>]  Step: 94ms | Tot: 55s287ms | Train >> Loss: 0.350 | Acc: 87.994% (43997/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s599ms | Test >> Loss: 0.568 | Acc: 83.790% (8379/10000) 79/79 
		
		Epoch: 34
		 [================================================================>]  Step: 96ms | Tot: 55s80ms | Train >> Loss: 0.334 | Acc: 88.502% (44251/50000) 391/391 
		 [================================================================>]  Step: 62ms | Tot: 3s430ms | Test >> Loss: 0.486 | Acc: 85.160% (8516/10000) 79/79 
		
		Epoch: 35
		 [================================================================>]  Step: 94ms | Tot: 55s172ms | Train >> Loss: 0.337 | Acc: 88.416% (44208/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s543ms | Test >> Loss: 0.477 | Acc: 85.280% (8528/10000) 79/79 
		
		Epoch: 36
		 [================================================================>]  Step: 97ms | Tot: 55s241ms | Train >> Loss: 0.325 | Acc: 88.726% (44363/50000) 391/391 
		 [================================================================>]  Step: 63ms | Tot: 3s564ms | Test >> Loss: 0.544 | Acc: 83.990% (8399/10000) 79/79 
		
		Epoch: 37
		 [================================================================>]  Step: 92ms | Tot: 55s299ms | Train >> Loss: 0.316 | Acc: 89.092% (44546/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s555ms | Test >> Loss: 0.444 | Acc: 86.170% (8617/10000) 79/79 
		
		Epoch: 38
		 [================================================================>]  Step: 96ms | Tot: 55s124ms | Train >> Loss: 0.311 | Acc: 89.384% (44692/50000) 391/391 
		 [================================================================>]  Step: 65ms | Tot: 3s434ms | Test >> Loss: 0.453 | Acc: 86.290% (8629/10000) 79/79 
		
		Epoch: 39
		 [================================================================>]  Step: 92ms | Tot: 55s154ms | Train >> Loss: 0.306 | Acc: 89.512% (44756/50000) 391/391 
		 [================================================================>]  Step: 63ms | Tot: 3s487ms | Test >> Loss: 0.447 | Acc: 86.680% (8668/10000) 79/79 
		
		Epoch: 40
		 [================================================================>]  Step: 92ms | Tot: 55s106ms | Train >> Loss: 0.305 | Acc: 89.462% (44731/50000) 391/391 
		 [================================================================>]  Step: 62ms | Tot: 3s523ms | Test >> Loss: 0.476 | Acc: 85.860% (8586/10000) 79/79 
		
		Epoch: 41
		 [================================================================>]  Step: 91ms | Tot: 55s232ms | Train >> Loss: 0.303 | Acc: 89.698% (44849/50000) 391/391 
		 [================================================================>]  Step: 62ms | Tot: 3s485ms | Test >> Loss: 0.474 | Acc: 85.950% (8595/10000) 79/79 
		
		Epoch: 42
		 [================================================================>]  Step: 97ms | Tot: 55s358ms | Train >> Loss: 0.286 | Acc: 90.182% (45091/50000) 391/391 
		 [================================================================>]  Step: 63ms | Tot: 3s500ms | Test >> Loss: 0.477 | Acc: 86.070% (8607/10000) 79/79 
		
		Epoch: 43
		 [================================================================>]  Step: 94ms | Tot: 55s208ms | Train >> Loss: 0.289 | Acc: 90.046% (45023/50000) 391/391 
		 [================================================================>]  Step: 68ms | Tot: 3s461ms | Test >> Loss: 0.455 | Acc: 86.360% (8636/10000) 79/79 
		
		Epoch: 44
		 [================================================================>]  Step: 91ms | Tot: 55s374ms | Train >> Loss: 0.281 | Acc: 90.308% (45154/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s502ms | Test >> Loss: 0.441 | Acc: 86.730% (8673/10000) 79/79 
		
		Epoch: 45
		 [================================================================>]  Step: 88ms | Tot: 55s293ms | Train >> Loss: 0.274 | Acc: 90.330% (45165/50000) 391/391 
		 [================================================================>]  Step: 63ms | Tot: 3s570ms | Test >> Loss: 0.464 | Acc: 86.070% (8607/10000) 79/79 
		
		Epoch: 46
		 [================================================================>]  Step: 95ms | Tot: 55s280ms | Train >> Loss: 0.272 | Acc: 90.476% (45238/50000) 391/391 
		 [================================================================>]  Step: 62ms | Tot: 3s559ms | Test >> Loss: 0.476 | Acc: 86.230% (8623/10000) 79/79 
		
		Epoch: 47
		 [================================================================>]  Step: 91ms | Tot: 55s223ms | Train >> Loss: 0.274 | Acc: 90.648% (45324/50000) 391/391 
		 [================================================================>]  Step: 61ms | Tot: 3s527ms | Test >> Loss: 0.429 | Acc: 87.240% (8724/10000) 79/79 
		
		Epoch: 48
		 [================================================================>]  Step: 97ms | Tot: 55s206ms | Train >> Loss: 0.266 | Acc: 90.974% (45487/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s534ms | Test >> Loss: 0.463 | Acc: 86.430% (8643/10000) 79/79 
		
		Epoch: 49
		 [================================================================>]  Step: 95ms | Tot: 55s61ms | Train >> Loss: 0.260 | Acc: 91.054% (45527/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s495ms | Test >> Loss: 0.500 | Acc: 85.790% (8579/10000) 79/79 
		
		Epoch: 50
		 [================================================================>]  Step: 95ms | Tot: 55s146ms | Train >> Loss: 0.255 | Acc: 91.254% (45627/50000) 391/391 
		 [================================================================>]  Step: 65ms | Tot: 3s573ms | Test >> Loss: 0.485 | Acc: 85.880% (8588/10000) 79/79 
		
		Epoch: 51
		 [================================================================>]  Step: 90ms | Tot: 55s329ms | Train >> Loss: 0.256 | Acc: 91.134% (45567/50000) 391/391 
		 [================================================================>]  Step: 65ms | Tot: 3s481ms | Test >> Loss: 0.494 | Acc: 86.510% (8651/10000) 79/79 
		
		Epoch: 52
		 [================================================================>]  Step: 93ms | Tot: 55s151ms | Train >> Loss: 0.251 | Acc: 91.406% (45703/50000) 391/391 
		 [================================================================>]  Step: 63ms | Tot: 3s538ms | Test >> Loss: 0.468 | Acc: 86.840% (8684/10000) 79/79 
		
		Epoch: 53
		 [================================================================>]  Step: 94ms | Tot: 55s107ms | Train >> Loss: 0.249 | Acc: 91.446% (45723/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s504ms | Test >> Loss: 0.428 | Acc: 87.370% (8737/10000) 79/79 
		
		Epoch: 54
		 [================================================================>]  Step: 92ms | Tot: 55s167ms | Train >> Loss: 0.242 | Acc: 91.686% (45843/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s502ms | Test >> Loss: 0.433 | Acc: 87.480% (8748/10000) 79/79 
		
		Epoch: 55
		 [================================================================>]  Step: 93ms | Tot: 55s188ms | Train >> Loss: 0.245 | Acc: 91.564% (45782/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s539ms | Test >> Loss: 0.459 | Acc: 86.590% (8659/10000) 79/79 
		
		Epoch: 56
		 [================================================================>]  Step: 97ms | Tot: 55s197ms | Train >> Loss: 0.237 | Acc: 91.732% (45866/50000) 391/391 
		 [================================================================>]  Step: 62ms | Tot: 3s487ms | Test >> Loss: 0.500 | Acc: 86.110% (8611/10000) 79/79 
		
		Epoch: 57
		 [================================================================>]  Step: 89ms | Tot: 55s147ms | Train >> Loss: 0.236 | Acc: 91.838% (45919/50000) 391/391 
		 [================================================================>]  Step: 62ms | Tot: 3s573ms | Test >> Loss: 0.440 | Acc: 87.420% (8742/10000) 79/79 
		
		Epoch: 58
		 [================================================================>]  Step: 93ms | Tot: 55s218ms | Train >> Loss: 0.231 | Acc: 92.094% (46047/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s579ms | Test >> Loss: 0.472 | Acc: 86.580% (8658/10000) 79/79 
		
		Epoch: 59
		 [================================================================>]  Step: 95ms | Tot: 55s70ms | Train >> Loss: 0.226 | Acc: 92.140% (46070/50000) 391/391 
		 [================================================================>]  Step: 64ms | Tot: 3s524ms | Test >> Loss: 0.427 | Acc: 87.880% (8788/10000) 79/79 
		
		Epoch: 60
		 [================================================================>]  Step: 91ms | Tot: 55s109ms | Train >> Loss: 0.229 | Acc: 92.214% (46107/50000) 391/391 
		 [================================================================>]  Step: 66ms | Tot: 3s588ms | Test >> Loss: 0.450 | Acc: 87.210% (8721/10000) 79/79 
    ```

- **Analysis**

  - No of Epochs : 60
  - Best Train Acc: 92.214%
  - Best Test Acc: 87.880%
  - No Model changes in Resnet18
  - Extra things done
    - Albumentation
    - Gradcam
    - Cutout
    
    - Normalization:
      - transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010))
    - Image augmentation
      - Train
         - HorizantalFlip
         - ShiftScaleRotate
         - RandomBrightnessContrast
         - Cutout
      - Test
         - Nothing
      
    ```
	class AlbumentationTransformTrain:
	    def __init__(self):
	        #print(dir(A))
	        self.transform = A.Compose([
	            A.HorizontalFlip(p=1),
	            #A.Rotate(limit=90),
	            A.ShiftScaleRotate(),
	            #A.RGBShift(),
	            A.RandomBrightnessContrast(),
	            #A.GaussNoise(),
	            A.Cutout(num_holes=1, max_h_size=16, max_w_size=16, fill_value=[0.4914, 0.4822, 0.4465], always_apply=False, p=0.5),
	            A.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),
	            T.ToTensor()
	        ])
	```
 