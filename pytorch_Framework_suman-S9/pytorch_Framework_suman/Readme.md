# EVA4 Assignment 10 - Suman Kanukollu



- [Github link](https://github.com/sumankanukollu/EVA_4_Assignments/blob/S_10_LRFinder_Misclassified_Cifar10/EVA_4_S10_Suman_Kanukollu_LRFinder_CIFAR_10.ipynb) 

- [Colab link](https://colab.research.google.com/drive/1jGgGJ6kNnGwnj_C2rKoKFs1vPw5mumDH?authuser=1#scrollTo=gnkSiJwdK-YX)

- **Model**: Resnet18

- No of parameters: 11,173,962

- No of Epochs ran: 50

- **Achieved : 88.530%** in 24th Epoch
- **Achieved : 90.020%** in 36th Epoch

- **Best Test Acc: 90.950%**

# Framework Structure:

	  - EVA_4_S10_Suman_Kanukollu_LRFinder_CIFAR_10.ipynb : It contains main workflow
	  - lib     : It contains all the functions related to Augmentation,Loaddataset,lrFinder,trainTestMethods
	  - models  : It contains Resnet model
	  - utils   : It contains helper functions such as progress bar and random images display and saveimages
	  - Sampleimages : Where user can place images for testing the code
	  - Output       : Network results will be saved here  

# Logs

  - **Best accuracy**
		  
	```
	
		Epoch: 46
		 [================================================================>]  Step: 44ms | Tot: 29s689ms | Train >> Loss: 0.163 | Acc: 94.420% (47210/50000) 391/391 
		 [================================================================>]  Step: 9ms | Tot: 2s540ms | Test >> Loss: 0.368 | Acc: 90.950% (9095/10000) 79/79 
		0.002903963778913021



  - **Full Log**

    ```
    
    
		
		Epoch: 1
		 [================================================================>]  Step: 44ms | Tot: 29s565ms | Train >> Loss: 1.359 | Acc: 51.012% (25506/50000) 391/391 
		 [================================================================>]  Step: 12ms | Tot: 2s649ms | Test >> Loss: 1.098 | Acc: 60.270% (6027/10000) 79/79 
		0.008674659079313278
		
		Epoch: 2
		 [================================================================>]  Step: 46ms | Tot: 29s718ms | Train >> Loss: 1.152 | Acc: 58.952% (29476/50000) 391/391 
		 [================================================================>]  Step: 13ms | Tot: 2s669ms | Test >> Loss: 1.003 | Acc: 64.280% (6428/10000) 79/79 
		0.007923910522460937
		
		Epoch: 3
		 [================================================================>]  Step: 44ms | Tot: 29s545ms | Train >> Loss: 0.997 | Acc: 64.812% (32406/50000) 391/391 
		 [================================================================>]  Step: 12ms | Tot: 2s631ms | Test >> Loss: 0.777 | Acc: 73.140% (7314/10000) 79/79 
		0.00613896187543869
		
		Epoch: 4
		 [================================================================>]  Step: 47ms | Tot: 29s651ms | Train >> Loss: 0.880 | Acc: 69.208% (34604/50000) 391/391 
		 [================================================================>]  Step: 11ms | Tot: 2s575ms | Test >> Loss: 0.758 | Acc: 74.300% (7430/10000) 79/79 
		0.005986256229877472
		
		Epoch: 5
		 [================================================================>]  Step: 45ms | Tot: 29s430ms | Train >> Loss: 0.792 | Acc: 72.126% (36063/50000) 391/391 
		 [================================================================>]  Step: 8ms | Tot: 2s587ms | Test >> Loss: 0.672 | Acc: 77.290% (7729/10000) 79/79 
		0.005311815068125725
		
		Epoch: 6
		 [================================================================>]  Step: 43ms | Tot: 29s587ms | Train >> Loss: 0.722 | Acc: 74.628% (37314/50000) 391/391 
		 [================================================================>]  Step: 12ms | Tot: 2s664ms | Test >> Loss: 0.624 | Acc: 79.010% (7901/10000) 79/79 
		0.004929242566227913
		
		Epoch: 7
		 [================================================================>]  Step: 45ms | Tot: 29s413ms | Train >> Loss: 0.672 | Acc: 76.658% (38329/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s596ms | Test >> Loss: 0.595 | Acc: 80.930% (8093/10000) 79/79 
		0.0046980346411466594
		
		Epoch: 8
		 [================================================================>]  Step: 47ms | Tot: 29s438ms | Train >> Loss: 0.621 | Acc: 78.374% (39187/50000) 391/391 
		 [================================================================>]  Step: 11ms | Tot: 2s615ms | Test >> Loss: 0.575 | Acc: 81.280% (8128/10000) 79/79 
		0.004542659914493561
		
		Epoch: 9
		 [================================================================>]  Step: 45ms | Tot: 29s345ms | Train >> Loss: 0.580 | Acc: 79.718% (39859/50000) 391/391 
		 [================================================================>]  Step: 8ms | Tot: 2s621ms | Test >> Loss: 0.512 | Acc: 82.420% (8242/10000) 79/79 
		0.0040485438734292984
		
		Epoch: 10
		 [================================================================>]  Step: 46ms | Tot: 29s171ms | Train >> Loss: 0.538 | Acc: 81.292% (40646/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s596ms | Test >> Loss: 0.504 | Acc: 83.460% (8346/10000) 79/79 
		0.0039846263766288754
		
		Epoch: 11
		 [================================================================>]  Step: 45ms | Tot: 29s376ms | Train >> Loss: 0.498 | Acc: 82.718% (41359/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s690ms | Test >> Loss: 0.443 | Acc: 84.770% (8477/10000) 79/79 
		0.0035022980958223345
		
		Epoch: 12
		 [================================================================>]  Step: 44ms | Tot: 29s442ms | Train >> Loss: 0.479 | Acc: 83.314% (41657/50000) 391/391 
		 [================================================================>]  Step: 13ms | Tot: 2s609ms | Test >> Loss: 0.444 | Acc: 84.850% (8485/10000) 79/79 
		0.0035079419910907747
		
		Epoch: 13
		 [================================================================>]  Step: 45ms | Tot: 29s208ms | Train >> Loss: 0.455 | Acc: 84.140% (42070/50000) 391/391 
		 [================================================================>]  Step: 8ms | Tot: 2s542ms | Test >> Loss: 0.469 | Acc: 85.050% (8505/10000) 79/79 
		0.0037024636059999464
		
		Epoch: 14
		 [================================================================>]  Step: 47ms | Tot: 29s509ms | Train >> Loss: 0.427 | Acc: 85.044% (42522/50000) 391/391 
		 [================================================================>]  Step: 14ms | Tot: 2s595ms | Test >> Loss: 0.420 | Acc: 86.450% (8645/10000) 79/79 
		0.0033163328126072883
		
		Epoch: 15
		 [================================================================>]  Step: 45ms | Tot: 29s581ms | Train >> Loss: 0.411 | Acc: 85.704% (42852/50000) 391/391 
		 [================================================================>]  Step: 8ms | Tot: 2s577ms | Test >> Loss: 0.466 | Acc: 85.020% (8502/10000) 79/79 
		0.0036797816932201384
		
		Epoch: 16
		 [================================================================>]  Step: 45ms | Tot: 29s491ms | Train >> Loss: 0.390 | Acc: 86.460% (43230/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s655ms | Test >> Loss: 0.560 | Acc: 83.370% (8337/10000) 79/79 
		0.004424400514364242
		
		Epoch: 17
		 [================================================================>]  Step: 46ms | Tot: 29s753ms | Train >> Loss: 0.370 | Acc: 87.000% (43500/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s607ms | Test >> Loss: 0.434 | Acc: 86.450% (8645/10000) 79/79 
		0.003424820664525032
		
		Epoch: 18
		 [================================================================>]  Step: 47ms | Tot: 29s692ms | Train >> Loss: 0.359 | Acc: 87.360% (43680/50000) 391/391 
		 [================================================================>]  Step: 12ms | Tot: 2s559ms | Test >> Loss: 0.437 | Acc: 86.370% (8637/10000) 79/79 
		0.003449856235086918
		
		Epoch: 19
		 [================================================================>]  Step: 46ms | Tot: 29s638ms | Train >> Loss: 0.338 | Acc: 88.158% (44079/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s674ms | Test >> Loss: 0.378 | Acc: 87.740% (8774/10000) 79/79 
		0.00298828050494194
		
		
		Epoch: 20
		 [================================================================>]  Step: 46ms | Tot: 29s962ms | Train >> Loss: 0.330 | Acc: 88.414% (44207/50000) 391/391 
		 [================================================================>]  Step: 13ms | Tot: 2s639ms | Test >> Loss: 0.425 | Acc: 87.130% (8713/10000) 79/79 
		0.003360782641172409
		
		Epoch: 21
		 [================================================================>]  Step: 46ms | Tot: 29s668ms | Train >> Loss: 0.314 | Acc: 88.880% (44440/50000) 391/391 
		 [================================================================>]  Step: 7ms | Tot: 2s581ms | Test >> Loss: 0.435 | Acc: 87.390% (8739/10000) 79/79 
		0.003438520163297653
		
		Epoch: 22
		 [================================================================>]  Step: 47ms | Tot: 29s626ms | Train >> Loss: 0.298 | Acc: 89.718% (44859/50000) 391/391 
		 [================================================================>]  Step: 13ms | Tot: 2s662ms | Test >> Loss: 0.432 | Acc: 87.130% (8713/10000) 79/79 
		0.0034130486518144606
		
		Epoch: 23
		 [================================================================>]  Step: 47ms | Tot: 29s901ms | Train >> Loss: 0.288 | Acc: 89.968% (44984/50000) 391/391 
		 [================================================================>]  Step: 11ms | Tot: 2s574ms | Test >> Loss: 0.413 | Acc: 87.700% (8770/10000) 79/79 
		0.0032641576677560806
		
		Epoch: 24
		 [================================================================>]  Step: 45ms | Tot: 29s417ms | Train >> Loss: 0.286 | Acc: 89.924% (44962/50000) 391/391 
		 [================================================================>]  Step: 12ms | Tot: 2s592ms | Test >> Loss: 0.404 | Acc: 88.530% (8853/10000) 79/79 
		0.0031946332901716234
		
		Epoch: 25
		 [================================================================>]  Step: 44ms | Tot: 29s465ms | Train >> Loss: 0.272 | Acc: 90.622% (45311/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s636ms | Test >> Loss: 0.419 | Acc: 87.920% (8792/10000) 79/79 
		0.003306704279780388
		
		Epoch: 26
		 [================================================================>]  Step: 45ms | Tot: 29s290ms | Train >> Loss: 0.262 | Acc: 90.926% (45463/50000) 391/391 
		 [================================================================>]  Step: 12ms | Tot: 2s602ms | Test >> Loss: 0.373 | Acc: 89.110% (8911/10000) 79/79 
		0.0029503302946686746
		
		Epoch: 27
		 [================================================================>]  Step: 46ms | Tot: 29s468ms | Train >> Loss: 0.253 | Acc: 91.218% (45609/50000) 391/391 
		 [================================================================>]  Step: 13ms | Tot: 2s614ms | Test >> Loss: 0.398 | Acc: 88.700% (8870/10000) 79/79 
		0.003142081926763058
		
		Epoch: 28
		 [================================================================>]  Step: 45ms | Tot: 29s458ms | Train >> Loss: 0.246 | Acc: 91.556% (45778/50000) 391/391 
		 [================================================================>]  Step: 11ms | Tot: 2s594ms | Test >> Loss: 0.364 | Acc: 89.070% (8907/10000) 79/79 
		0.0028782573372125625
		
		Epoch: 29
		 [================================================================>]  Step: 47ms | Tot: 29s541ms | Train >> Loss: 0.238 | Acc: 91.842% (45921/50000) 391/391 
		 [================================================================>]  Step: 9ms | Tot: 2s615ms | Test >> Loss: 0.362 | Acc: 89.060% (8906/10000) 79/79 
		0.0028614354997873307
		
		Epoch: 30
		 [================================================================>]  Step: 45ms | Tot: 29s386ms | Train >> Loss: 0.233 | Acc: 91.804% (45902/50000) 391/391 
		 [================================================================>]  Step: 11ms | Tot: 2s556ms | Test >> Loss: 0.374 | Acc: 89.170% (8917/10000) 79/79 
		0.0029519511744379996
		
		Epoch: 31
		 [================================================================>]  Step: 47ms | Tot: 29s401ms | Train >> Loss: 0.230 | Acc: 91.954% (45977/50000) 391/391 
		 [================================================================>]  Step: 9ms | Tot: 2s577ms | Test >> Loss: 0.366 | Acc: 89.840% (8984/10000) 79/79 
		0.0028877260342240335
		
		Epoch: 32
		 [================================================================>]  Step: 46ms | Tot: 29s458ms | Train >> Loss: 0.222 | Acc: 92.410% (46205/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s555ms | Test >> Loss: 0.382 | Acc: 89.480% (8948/10000) 79/79 
		0.003021055956184864
		
		Epoch: 33
		 [================================================================>]  Step: 45ms | Tot: 29s325ms | Train >> Loss: 0.216 | Acc: 92.580% (46290/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s575ms | Test >> Loss: 0.380 | Acc: 89.130% (8913/10000) 79/79 
		0.0030021576821804047
		
		Epoch: 34
		 [================================================================>]  Step: 46ms | Tot: 29s594ms | Train >> Loss: 0.213 | Acc: 92.634% (46317/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s548ms | Test >> Loss: 0.409 | Acc: 88.860% (8886/10000) 79/79 
		0.003230854748189449
		
		Epoch: 35
		 [================================================================>]  Step: 47ms | Tot: 29s207ms | Train >> Loss: 0.203 | Acc: 92.958% (46479/50000) 391/391 
		 [================================================================>]  Step: 8ms | Tot: 2s543ms | Test >> Loss: 0.401 | Acc: 89.200% (8920/10000) 79/79 
		0.0031661013156175613
		
		Epoch: 36
		 [================================================================>]  Step: 45ms | Tot: 29s285ms | Train >> Loss: 0.199 | Acc: 93.034% (46517/50000) 391/391 
		 [================================================================>]  Step: 9ms | Tot: 2s570ms | Test >> Loss: 0.376 | Acc: 90.020% (9002/10000) 79/79 
		0.002966749085485935
		
		Epoch: 37
		 [================================================================>]  Step: 45ms | Tot: 29s489ms | Train >> Loss: 0.198 | Acc: 93.122% (46561/50000) 391/391 
		 [================================================================>]  Step: 14ms | Tot: 2s626ms | Test >> Loss: 0.371 | Acc: 89.710% (8971/10000) 79/79 
		0.0029286296531558036
		
		Epoch: 38
		 [================================================================>]  Step: 47ms | Tot: 29s514ms | Train >> Loss: 0.193 | Acc: 93.306% (46653/50000) 391/391 
		 [================================================================>]  Step: 8ms | Tot: 2s617ms | Test >> Loss: 0.357 | Acc: 89.780% (8978/10000) 79/79 
		0.002819886428117752
		
		Epoch: 39
		 [================================================================>]  Step: 49ms | Tot: 29s349ms | Train >> Loss: 0.189 | Acc: 93.460% (46730/50000) 391/391 
		 [================================================================>]  Step: 11ms | Tot: 2s601ms | Test >> Loss: 0.391 | Acc: 89.570% (8957/10000) 79/79 
		0.0030869736045598985
		
		Epoch: 40
		 [================================================================>]  Step: 45ms | Tot: 29s518ms | Train >> Loss: 0.182 | Acc: 93.620% (46810/50000) 391/391 
		 [================================================================>]  Step: 8ms | Tot: 2s550ms | Test >> Loss: 0.372 | Acc: 89.720% (8972/10000) 79/79 
		0.002939188724756241


		Epoch: 41
		 [================================================================>]  Step: 44ms | Tot: 29s246ms | Train >> Loss: 0.175 | Acc: 93.808% (46904/50000) 391/391 
		 [================================================================>]  Step: 11ms | Tot: 2s629ms | Test >> Loss: 0.377 | Acc: 89.620% (8962/10000) 79/79 
		0.0029806596502661704
		
		Epoch: 42
		 [================================================================>]  Step: 46ms | Tot: 29s391ms | Train >> Loss: 0.176 | Acc: 93.914% (46957/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s638ms | Test >> Loss: 0.327 | Acc: 90.810% (9081/10000) 79/79 
		0.002583533164858818
		
		Epoch: 43
		 [================================================================>]  Step: 42ms | Tot: 29s476ms | Train >> Loss: 0.169 | Acc: 94.172% (47086/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s645ms | Test >> Loss: 0.358 | Acc: 90.210% (9021/10000) 79/79 
		0.0028290782913565635
		
		Epoch: 44
		 [================================================================>]  Step: 45ms | Tot: 29s538ms | Train >> Loss: 0.167 | Acc: 94.182% (47091/50000) 391/391 
		 [================================================================>]  Step: 12ms | Tot: 2s542ms | Test >> Loss: 0.368 | Acc: 90.410% (9041/10000) 79/79 
		0.002904209789633751
		
		Epoch: 45
		 [================================================================>]  Step: 47ms | Tot: 29s686ms | Train >> Loss: 0.175 | Acc: 93.978% (46989/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s573ms | Test >> Loss: 0.357 | Acc: 90.700% (9070/10000) 79/79 
		0.002820640403032303
		
		Epoch: 46
		 [================================================================>]  Step: 44ms | Tot: 29s689ms | Train >> Loss: 0.163 | Acc: 94.420% (47210/50000) 391/391 
		 [================================================================>]  Step: 9ms | Tot: 2s540ms | Test >> Loss: 0.368 | Acc: 90.950% (9095/10000) 79/79 
		0.002903963778913021
		
		Epoch: 47
		 [================================================================>]  Step: 45ms | Tot: 29s371ms | Train >> Loss: 0.162 | Acc: 94.414% (47207/50000) 391/391 
		 [================================================================>]  Step: 10ms | Tot: 2s559ms | Test >> Loss: 0.384 | Acc: 89.860% (8986/10000) 79/79 
		0.003035607314109802
		
		Epoch: 48
		 [================================================================>]  Step: 45ms | Tot: 29s379ms | Train >> Loss: 0.159 | Acc: 94.420% (47210/50000) 391/391 
		 [================================================================>]  Step: 9ms | Tot: 2s571ms | Test >> Loss: 0.382 | Acc: 90.050% (9005/10000) 79/79 
		0.0030200322017073632
		
		Epoch: 49
		 [================================================================>]  Step: 46ms | Tot: 29s500ms | Train >> Loss: 0.159 | Acc: 94.510% (47255/50000) 391/391 
		 [================================================================>]  Step: 11ms | Tot: 2s584ms | Test >> Loss: 0.384 | Acc: 90.430% (9043/10000) 79/79 
		0.0030331631109118463
		
		Epoch: 50
		 [================================================================>]  Step: 46ms | Tot: 29s377ms | Train >> Loss: 0.150 | Acc: 94.838% (47419/50000) 391/391 
		 [================================================================>]  Step: 13ms | Tot: 2s603ms | Test >> Loss: 0.370 | Acc: 90.000% (9000/10000) 79/79 
		0.0029242775574326516

    ```

- **Analysis**

  - No of Epochs : 60
  - Best Train Acc: 92.214%
  - Best Test Acc: 87.880%
  - No Model changes in Resnet18
  - Extra things done
    - Albumentation
    - Gradcam
    - Cutout
    
    - Normalization:
      - transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010))
    - Image augmentation
      - Train
         - HorizantalFlip
         - ShiftScaleRotate
         - RandomBrightnessContrast
         - Cutout
      - Test
         - Nothing
      
    ```
	class AlbumentationTransformTrain:
	    def __init__(self):
	        #print(dir(A))
	        self.transform = A.Compose([
	            A.HorizontalFlip(p=1),
	            #A.Rotate(limit=90),
	            A.ShiftScaleRotate(),
	            #A.RGBShift(),
	            A.RandomBrightnessContrast(),
	            #A.GaussNoise(),
	            A.Cutout(num_holes=1, max_h_size=16, max_w_size=16, fill_value=[0.4914, 0.4822, 0.4465], always_apply=False, p=0.5),
	            A.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),
	            T.ToTensor()
	        ])
	```
 